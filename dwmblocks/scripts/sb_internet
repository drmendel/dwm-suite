#!/bin/bash

# Map index to interface
ETH_IF=$(ip -o link show | awk -F': ' '$1==2 {print $2}')
WIFI_IF=$(ip -o link show | awk -F': ' '$1==3 {print $2}')

# Check connections
wifi_connected=false
eth_connected=false

# Wi-Fi
if iw dev "$WIFI_IF" link | grep -q "Connected"; then
    wifi_connected=true
fi

# Ethernet
if ip link show "$ETH_IF" | grep -q "state UP"; then
    if ip addr show "$ETH_IF" | grep -q "inet "; then
        eth_connected=true
    fi
fi

# Determine output
if $eth_connected; then
    icon="󰈀 "
    ip=$(ip -4 addr show "$ETH_IF" | grep -oP '(?<=inet\s)\d+(\.\d+){3}')
elif $wifi_connected; then
    icon="󰖩 "
    ip=$(ip -4 addr show "$WIFI_IF" | grep -oP '(?<=inet\s)\d+(\.\d+){3}')
else
    icon="󰖪 "
    ip=""
fi

# Print
if [ -n "$ip" ]; then
    printf "$icon%s" "$ip"
else
    printf "$icon"
fi

